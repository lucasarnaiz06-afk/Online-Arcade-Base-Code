<!DOCTYPE html>
<html lang="en">
<head>
  {% if current_user.is_authenticated %}
  <script>
      window.addEventListener('DOMContentLoaded', function () {
          const serverTheme = "{{ current_user.theme }}";
          localStorage.setItem('theme', serverTheme);
          if (typeof applyTheme === 'function') {
              applyTheme(serverTheme);
          }
      });
  </script>
  {% endif %}
  <script src="/js/theme-init.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arcade Games</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
  <style>
    .game-card img {
      height: 220px !important;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  {% include 'navbar.html' %}

  <div class="container mt-4">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-controller"></i> Choose a Game</h5>
      </div>
      <div class="card-body">
        <div class="game-grid">
          <a href="{{ url_for('blackjack') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/blackjack.jpg') }}" alt="Blackjack">
            <h3>Blackjack</h3>
          </a>

          <a href="{{ url_for('mines') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/mines.jpg') }}" alt="Mines">
            <h3>Mines</h3>
          </a>

          <a href="{{ url_for('slots_animated') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/slots.jpg') }}" alt="Slots">
            <h3>Slots</h3>
          </a>
          
          <a href="{{ url_for('plinko') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/plinko.jpg') }}" alt="Plinko">
            <h3>Plinko</h3>
          </a>
          
          <a href="{{ url_for('balloon_rise') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/balloon_rise.jpg') }}" alt="balloon_rise">
            <h3>Balloon Rise</h3>
          </a>
          
          <a href="{{ url_for('ladder_climb') }}" class="game-card">
            <img src="{{ url_for('static', filename='images/avatars/ladder_climb.jpg') }}" alt="ladder_climb">
            <h3>Ladder Climb</h3>
          </a>
        </div>
      </div>
    </div>
  </div>

  <footer class="bg-dark text-white text-center py-3 mt-5">
    <p>&copy; 2025 Online Arcade. All rights reserved.</p>
  </footer>

  <script>
        // Function to apply theme (GLOBAL SCOPE)
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-theme');
                // Adjust card and list group colors for dark theme
                document.querySelectorAll('.card, .list-group-item').forEach(item => {
                    item.classList.add('dark-mode');
                });
            } else if (theme === 'light') {
                document.body.classList.remove('dark-theme');
                document.querySelectorAll('.card, .list-group-item').forEach(item => {
                    item.classList.remove('dark-mode');
                });
            } else if (theme === 'system') {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (prefersDark) {
                    document.body.classList.add('dark-theme');
                    document.querySelectorAll('.card, .list-group-item').forEach(item => {
                        item.classList.add('dark-mode');
                    });
                } else {
                    document.body.classList.remove('dark-theme');
                    document.querySelectorAll('.card, .list-group-item').forEach(item => {
                        item.classList.remove('dark-mode');
                    });
                }
            }
        }

        // Apply theme and accent color based on user settings
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial theme and accent based on user settings
            const userTheme = "{{ current_user.theme }}";
            
            // Set the radio button for theme
            if (document.getElementById(userTheme + 'Theme')) {
                document.getElementById(userTheme + 'Theme').checked = true;
            }
            
            // Apply theme to page
            applyTheme(userTheme);
           
            
            // Event listeners for theme changes (live preview)
            document.querySelectorAll('input[name="theme"]').forEach(function(radio) {
                radio.addEventListener('change', function() {
                    applyTheme(this.value);
                });
            });
        });
  </script>
</body>
</html>